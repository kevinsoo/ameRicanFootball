# parse win-loss columns
playoffs$WinLoss[i] <- strsplit(playoffs$Result[i], " ")[[1]][1]
score <- strsplit(playoffs$Result[i], " ")[[1]][2]
playoffs$ScoreTeam[i] <- strsplit(score, "-")[[1]][1]
playoffs$ScoreOpp[i] <- strsplit(score, "-")[[1]][2]
# parse age columns
playoffs$AgeYears[i] <- strsplit(playoffs$Age[i], "-")[[1]][1]
playoffs$AgeDays[i] <- strsplit(playoffs$Age[i], "-")[[1]][2]
}
# recode columns
playoffs$HomeAway <- ifelse(playoffs$HomeAway=="@", "A", ifelse(playoffs$HomeAway=="", "H", "N"))
playoffs$Start <- ifelse(playoffs$Start=="", 0, 1)
playoffs$AgeDays <- as.numeric(playoffs$AgeDays)
playoffs$Type <- "Playoffs"
# select columns
playoffs <- playoffs %>% select(Type, Year:GameNum,
AgeYears, AgeDays,
Team:Opponent,
WinLoss:ScoreOpp,
Start:AdjustedYardsPerPassAttempt)
# combine data frames
allStats <- rbind(regularSeason, playoffs) %>% arrange(Date)
Game <- 1:nrow(allStats)
Player <- rep(qbs[q], nrow(allStats))
allStats <- data.frame(Player, Game, allStats)
}
# if no playoff stats
if (length(player)==1) {
allStats <- regularSeason %>% arrange(Date)
Game <- 1:nrow(allStats)
Player <- rep(qbs[q], nrow(allStats))
allStats <- data.frame(Player, Game, allStats)
}
# combine players
if (q==1) { QBStats <- allStats }
else { QBStats <- rbind(QBStats, allStats) }
}
# set data types
QBStats$Player <- as.factor(QBStats$Player)
QBStats$Game <- as.numeric(QBStats$Game)
QBStats$Year <- as.numeric(QBStats$Year)
QBStats$Date <- as.Date(QBStats$Date)
QBStats$GameNum <- as.numeric(QBStats$GameNum)
QBStats$AgeYears <- as.numeric(QBStats$AgeYears)
QBStats$AgeDays <- as.numeric(QBStats$AgeDays)
QBStats$Team <- as.factor(QBStats$Team)
QBStats$HomeAway <- as.factor(QBStats$HomeAway)
QBStats$Opponent <- as.factor(QBStats$Opponent)
QBStats$WinLoss <- as.factor(QBStats$WinLoss)
QBStats$ScoreTeam <- as.numeric(QBStats$ScoreTeam)
QBStats$ScoreOpp <- as.numeric(QBStats$ScoreOpp)
QBStats$Start <- as.factor(QBStats$Start)
QBStats$PassComplete <- as.numeric(QBStats$PassComplete)
QBStats$PassAttempt <- as.numeric(QBStats$PassAttempt)
QBStats$PassAccuracy <- as.numeric(QBStats$PassAccuracy)
QBStats$PassYards <- as.numeric(QBStats$PassYards)
QBStats$PassTD <- as.numeric(QBStats$PassTD)
QBStats$PassIntercepted <- as.numeric(QBStats$PassIntercepted)
QBStats$QBRating <- as.numeric(QBStats$QBRating)
QBStats$Sacked <- as.numeric(QBStats$Sacked)
QBStats$YardsLost <- as.numeric(QBStats$YardsLost)
QBStats$YardsPerPassAttempt <- as.numeric(QBStats$YardsPerPassAttempt)
QBStats$AdjustedYardsPerPassAttempt <- as.numeric(QBStats$AdjustedYardsPerPassAttempt)
# save data
save(QBStats, file="QBStats.Rda")
library(tidyverse)
library(ggthemes)
load("QBStats.Rda")
QBStats$Period <- ifelse(as.numeric(as.Date(QBStats$Date)) < as.numeric(as.Date("2006-09-01")), "Pre",
ifelse(as.numeric(as.Date(QBStats$Date)) < as.numeric(as.Date("2015-09-01")), "During", "Current"))
PassStats <- QBStats %>% filter(Player!="Tom Brady", Type=="RegularSeason") %>%
group_by(Year, GameNum) %>%
summarise(Attempts.M=mean(PassAttempt), Attempts.SD=sd(PassAttempt),
Completed.M=mean(PassComplete), Completed.SD=sd(PassComplete),
Accuracy.M=mean(PassAccuracy), Accuracy.SD=sd(PassAccuracy))
head(PassStats)
PassStats$GameWeek <- paste(PassStats$Year, "-", PassStats$GameNum) # label time
ggplot(PassStats, aes(x=GameWeek, y=Accuracy.M)) + geom_path()
head(PassStats)
PassStats$GameWeek <- paste(PassStats$Year, "-", PassStats$GameNum, sep="") # label time
ggplot(PassStats, aes(x=GameWeek, y=Accuracy.M)) + geom_path()
PassStats$GameWeek <- as.Date(paste(PassStats$Year, "-", PassStats$GameNum, sep="")) # label time
PassStats <- QBStats %>% filter(Player!="Tom Brady", Type=="RegularSeason") %>%
group_by(Year, GameNum) %>%
summarise(Date=as.Date(mean(as.numeric(as.Date(Date)))),
Attempts.M=mean(PassAttempt), Attempts.SD=sd(PassAttempt),
Completed.M=mean(PassComplete), Completed.SD=sd(PassComplete),
Accuracy.M=mean(PassAccuracy), Accuracy.SD=sd(PassAccuracy))
PassStats <- QBStats %>% filter(Player!="Tom Brady", Type=="RegularSeason") %>%
group_by(Year, GameNum) %>%
summarise(AverageDate=as.Date(mean(as.numeric(as.Date(Date)))),
Attempts.M=mean(PassAttempt), Attempts.SD=sd(PassAttempt),
Completed.M=mean(PassComplete), Completed.SD=sd(PassComplete),
Accuracy.M=mean(PassAccuracy), Accuracy.SD=sd(PassAccuracy))
Date<-QBStats$Date
as.Date(mean(as.numeric(as.Date(Date))))
as.Date(Date)
as.numeric(as.Date(Date))
mean(as.numeric(as.Date(Date)))
as.Date(mean(as.numeric(as.Date(Date))))
PassStats <- QBStats %>% filter(Player!="Tom Brady", Type=="RegularSeason") %>%
group_by(Year, GameNum) %>%
summarise(AverageDate=as.Date(mean(as.numeric(as.Date(Date))), origin="2003-09-01"),
Attempts.M=mean(PassAttempt), Attempts.SD=sd(PassAttempt),
Completed.M=mean(PassComplete), Completed.SD=sd(PassComplete),
Accuracy.M=mean(PassAccuracy), Accuracy.SD=sd(PassAccuracy))
PassStats <- QBStats %>% filter(Player!="Tom Brady", Type=="RegularSeason") %>%
group_by(Year, GameNum) %>%
summarise(AverageDate=as.Date(mean(as.numeric(as.Date(Date))), origin="2000-09-01"),
Attempts.M=mean(PassAttempt), Attempts.SD=sd(PassAttempt),
Completed.M=mean(PassComplete), Completed.SD=sd(PassComplete),
Accuracy.M=mean(PassAccuracy), Accuracy.SD=sd(PassAccuracy))
PassStats <- QBStats %>% filter(Player!="Tom Brady", Type=="RegularSeason") %>%
group_by(Year, GameNum) %>%
summarise(AverageDate=as.Date(mean(as.numeric(as.Date(Date))), origin="1900-09-01"),
Attempts.M=mean(PassAttempt), Attempts.SD=sd(PassAttempt),
Completed.M=mean(PassComplete), Completed.SD=sd(PassComplete),
Accuracy.M=mean(PassAccuracy), Accuracy.SD=sd(PassAccuracy))
PassStats <- QBStats %>% filter(Player!="Tom Brady", Type=="RegularSeason") %>%
group_by(Year, GameNum) %>%
summarise(AverageDate=as.Date(mean(as.numeric(as.Date(Date))), origin=500),
Attempts.M=mean(PassAttempt), Attempts.SD=sd(PassAttempt),
Completed.M=mean(PassComplete), Completed.SD=sd(PassComplete),
Accuracy.M=mean(PassAccuracy), Accuracy.SD=sd(PassAccuracy))
PassStats <- QBStats %>% filter(Player!="Tom Brady", Type=="RegularSeason") %>%
group_by(Year, GameNum) %>%
summarise(AverageDate=as.Date(mean(as.numeric(as.Date(Date))), origin=as.Date(500)),
Attempts.M=mean(PassAttempt), Attempts.SD=sd(PassAttempt),
Completed.M=mean(PassComplete), Completed.SD=sd(PassComplete),
Accuracy.M=mean(PassAccuracy), Accuracy.SD=sd(PassAccuracy))
PassStats <- QBStats %>% filter(Player!="Tom Brady", Type=="RegularSeason") %>%
group_by(Year, GameNum) %>%
summarise(AverageDate=as.Date(mean(as.numeric(as.Date(Date))), origin="1950-09-01"),
Attempts.M=mean(PassAttempt), Attempts.SD=sd(PassAttempt),
Completed.M=mean(PassComplete), Completed.SD=sd(PassComplete),
Accuracy.M=mean(PassAccuracy), Accuracy.SD=sd(PassAccuracy))
PassStats <- QBStats %>% filter(Player!="Tom Brady", Type=="RegularSeason") %>%
group_by(Year, GameNum) %>%
summarise(AverageDate=as.Date(mean(as.numeric(as.Date(Date))), origin="1990-09-01"),
Attempts.M=mean(PassAttempt), Attempts.SD=sd(PassAttempt),
Completed.M=mean(PassComplete), Completed.SD=sd(PassComplete),
Accuracy.M=mean(PassAccuracy), Accuracy.SD=sd(PassAccuracy))
PassStats <- QBStats %>% filter(Player!="Tom Brady", Type=="RegularSeason") %>%
group_by(Year, GameNum) %>%
summarise(AverageDate=as.Date(mean(as.numeric(as.Date(Date))), origin="1970-09-01"),
Attempts.M=mean(PassAttempt), Attempts.SD=sd(PassAttempt),
Completed.M=mean(PassComplete), Completed.SD=sd(PassComplete),
Accuracy.M=mean(PassAccuracy), Accuracy.SD=sd(PassAccuracy))
PassStats <- QBStats %>% filter(Player!="Tom Brady", Type=="RegularSeason") %>%
group_by(Year, GameNum) %>%
summarise(AverageDate=as.Date(mean(as.numeric(as.Date(Date))), origin="1969-09-01"),
Attempts.M=mean(PassAttempt), Attempts.SD=sd(PassAttempt),
Completed.M=mean(PassComplete), Completed.SD=sd(PassComplete),
Accuracy.M=mean(PassAccuracy), Accuracy.SD=sd(PassAccuracy))
PassStats <- QBStats %>% filter(Player!="Tom Brady", Type=="RegularSeason") %>%
group_by(Year, GameNum) %>%
summarise(AverageDate=as.Date(mean(as.numeric(as.Date(Date))), origin="1969-12-01"),
Attempts.M=mean(PassAttempt), Attempts.SD=sd(PassAttempt),
Completed.M=mean(PassComplete), Completed.SD=sd(PassComplete),
Accuracy.M=mean(PassAccuracy), Accuracy.SD=sd(PassAccuracy))
PassStats <- QBStats %>% filter(Player!="Tom Brady", Type=="RegularSeason") %>%
group_by(Year, GameNum) %>%
summarise(AverageDate=as.Date(mean(as.numeric(as.Date(Date))), origin="1970-01-01"),
Attempts.M=mean(PassAttempt), Attempts.SD=sd(PassAttempt),
Completed.M=mean(PassComplete), Completed.SD=sd(PassComplete),
Accuracy.M=mean(PassAccuracy), Accuracy.SD=sd(PassAccuracy))
ggplot(PassStats, aes(x=AverageDate, y=Accuracy.M)) + geom_path()
ggplot(PassStats, aes(x=AverageDate, y=Accuracy.M)) + geom_smooth()
library(tidyverse)
library(ggthemes)
load("QBStats.Rda")
QBStats$Period <- ifelse(as.numeric(as.Date(QBStats$Date)) < as.numeric(as.Date("2006-09-01")), "Pre",
ifelse(as.numeric(as.Date(QBStats$Date)) < as.numeric(as.Date("2015-09-01")), "During", "Current"))
PassStats <- QBStats %>% filter(Player!="Tom Brady", Type=="RegularSeason") %>%
group_by(Year, GameNum) %>%
summarise(AverageDate=as.Date(mean(as.numeric(as.Date(Date))), origin="1970-01-01"),
Attempts.M=mean(PassAttempt), Attempts.SD=sd(PassAttempt),
Completed.M=mean(PassComplete), Completed.SD=sd(PassComplete),
Accuracy.M=mean(PassAccuracy), Accuracy.SD=sd(PassAccuracy))
ggplot(PassStats, aes(x=AverageDate, y=Accuracy.M)) + geom_smooth()
ggplot(QBStats, aes(x=Date, group=Player, y=PassAccuracy)) +
geom_point(aes(color=Player), alpha=0.2) +
geom_vline(xintercept = as.numeric(as.Date(c("2006-09-01", "2015-09-01"))), linetype="dashed") +
# stat_smooth(aes(color=Player), method="lm") +
scale_x_date() +
theme_minimal()
PassStats <- QBStats %>% filter(Player!="Tom Brady", Type=="RegularSeason", Year>=2004) %>%
group_by(Year, GameNum) %>%
summarise(AverageDate=as.Date(mean(as.numeric(as.Date(Date))), origin="1970-01-01"),
Attempts.M=mean(PassAttempt), Attempts.SD=sd(PassAttempt),
Completed.M=mean(PassComplete), Completed.SD=sd(PassComplete),
Accuracy.M=mean(PassAccuracy), Accuracy.SD=sd(PassAccuracy))
ggplot(PassStats, aes(x=AverageDate, y=Accuracy.M)) + geom_smooth()
ggplot(QBStats, aes(x=Date, group=Player, y=PassAccuracy)) +
geom_point(aes(color=Player), alpha=0.2) +
geom_vline(xintercept = as.numeric(as.Date(c("2006-09-01", "2015-09-01"))), linetype="dashed") +
# stat_smooth(aes(color=Player), method="lm") +
scale_x_date() +
theme_minimal()
PassStats <- QBStats %>% filter(Player!="Tom Brady", Type=="RegularSeason", Year>=2005) %>%
group_by(Year, GameNum) %>%
summarise(AverageDate=as.Date(mean(as.numeric(as.Date(Date))), origin="1970-01-01"),
Attempts.M=mean(PassAttempt), Attempts.SD=sd(PassAttempt),
Completed.M=mean(PassComplete), Completed.SD=sd(PassComplete),
Accuracy.M=mean(PassAccuracy), Accuracy.SD=sd(PassAccuracy))
ggplot(PassStats, aes(x=AverageDate, y=Accuracy.M)) + geom_smooth()
4
4
PassStats <- QBStats %>% filter(Player!="Tom Brady", Type=="RegularSeason", Year>=2004) %>%
group_by(Year, GameNum) %>%
summarise(AverageDate=as.Date(mean(as.numeric(as.Date(Date))), origin="1970-01-01"),
Attempts.M=mean(PassAttempt), Attempts.SD=sd(PassAttempt),
Completed.M=mean(PassComplete), Completed.SD=sd(PassComplete),
Accuracy.M=mean(PassAccuracy), Accuracy.SD=sd(PassAccuracy))
ggplot(PassStats, aes(x=AverageDate, y=Accuracy.M)) + geom_smooth()
ggplot(QBStats, aes(x=Date, group=Player, y=PassAccuracy)) +
geom_point(aes(color=Player), alpha=0.2) +
geom_vline(xintercept = as.numeric(as.Date(c("2006-09-01", "2015-09-01"))), linetype="dashed") +
# stat_smooth(aes(color=Player), method="lm") +
scale_x_date() +
theme_minimal()
ggplot(QBStats, aes(x=Date, group=Player, y=PassAccuracy)) +
geom_point(aes(color=Player), alpha=0.2) +
geom_vline(xintercept = as.numeric(as.Date(c("2006-09-01", "2015-09-01"))), linetype="dashed") +
stat_smooth(method="lm") +
scale_x_date() +
theme_minimal()
ggplot(QBStats, aes(x=Date, y=PassAccuracy)) +
geom_point(aes(color=Player), alpha=0.2) +
geom_vline(xintercept = as.numeric(as.Date(c("2006-09-01", "2015-09-01"))), linetype="dashed") +
stat_smooth(method="lm") +
scale_x_date() +
theme_minimal()
QBStats$QB <- as.factor(ifelse(QBStats$Player=="Aaron Rodgers", QBStats$Player,
ifelse(QBStats$Player=="Tom Brady", QBStats$Player, "Other")))
ggplot(QBStats, aes(x=Date, y=PassAccuracy)) +
geom_point(aes(color=QB), alpha=0.2) +
geom_vline(xintercept = as.numeric(as.Date(c("2006-09-01", "2015-09-01"))), linetype="dashed") +
stat_smooth(method="lm") +
scale_x_date() +
theme_minimal()
QBStats$QB <- as.factor(ifelse(QBStats$Player=="Aaron Rodgers", "Aaron Rodgers",
ifelse(QBStats$Player=="Tom Brady", "Tom Brady", "Other")))
head(QBStats)
ggplot(QBStats, aes(x=Date, y=PassAccuracy)) +
geom_point(aes(color=QB), alpha=0.2) +
geom_vline(xintercept = as.numeric(as.Date(c("2006-09-01", "2015-09-01"))), linetype="dashed") +
stat_smooth(method="lm") +
scale_x_date() +
theme_minimal()
ggplot(QBStats, aes(x=Date, group=QB, y=PassAccuracy)) +
geom_point(aes(color=QB), alpha=0.2) +
geom_vline(xintercept = as.numeric(as.Date(c("2006-09-01", "2015-09-01"))), linetype="dashed") +
stat_smooth(method="lm", aes(color=QB)) +
scale_x_date() +
theme_minimal()
theme_set(theme_bw())
ggplot(QBStats, aes(x=Date, group=QB, y=QBRating
geom_point(aes(color=QB), alpha=0.2) +
geom_vline(xintercept = as.numeric(as.Date(c("2006-09-01", "2015-09-01"))), linetype="dashed") +
stat_smooth(method="lm", aes(color=QB)) +
scale_x_date()
ggplot(QBStats, aes(x=Date, group=QB, y=QBRating)) +
geom_point(aes(color=QB), alpha=0.2) +
geom_vline(xintercept = as.numeric(as.Date(c("2006-09-01", "2015-09-01"))), linetype="dashed") +
stat_smooth(method="lm", aes(color=QB)) +
scale_x_date()
ggplot(QBStats, aes(x=Date, group=QB, y=PassAccuracy)) +
geom_point(aes(color=QB), alpha=0.2) +
geom_path(filter(QBStats, QB %in% c("Tom Brady", "Aaron Rodgers")), aes(y=PassAccuracy, x=Date)) +
geom_vline(xintercept = as.numeric(as.Date(c("2006-09-01", "2015-09-01"))), linetype="dashed") +
stat_smooth(method="lm", aes(color=QB)) +
scale_x_date()
filter(QBStats, QB %in% c("Tom Brady", "Aaron Rodgers"))
ggplot(QBStats, aes(x=Date, group=QB, y=PassAccuracy)) +
geom_point(aes(color=QB), alpha=0.2) +
geom_path(filter(QBStats, QB %in% c("Tom Brady", "Aaron Rodgers")), aes(y=PassAccuracy, x=Date)) +
geom_vline(xintercept = as.numeric(as.Date(c("2006-09-01", "2015-09-01"))), linetype="dashed") +
stat_smooth(method="lm", aes(color=QB)) +
scale_x_date()
ggplot(QBStats, aes(x=Date, group=QB, y=PassAccuracy)) +
geom_point(aes(color=QB), alpha=0.2) +
geom_path(aes(y=PassAccuracy, x=Date)) +
geom_vline(xintercept = as.numeric(as.Date(c("2006-09-01", "2015-09-01"))), linetype="dashed") +
stat_smooth(method="lm", aes(color=QB)) +
scale_x_date()
ggplot(QBStats, aes(x=Date, group=Player, y=PassAccuracy)) +
geom_point(aes(color=QB), alpha=0.2) +
geom_path(aes(y=PassAccuracy, x=Date)) +
geom_vline(xintercept = as.numeric(as.Date(c("2006-09-01", "2015-09-01"))), linetype="dashed") +
stat_smooth(method="lm", aes(color=QB)) +
scale_x_date()
ggplot(QBStats, aes(x=Date, group=QB, y=PassAccuracy)) +
geom_point(aes(color=QB), alpha=0.2) +
geom_vline(xintercept = as.numeric(as.Date(c("2006-09-01", "2015-09-01"))), linetype="dashed") +
stat_smooth(method="lm", aes(color=QB)) +
scale_x_date()
library(tidyverse)
ggplot(QBStats, aes(x=Date, group=QB, y=PassAccuracy)) +
geom_point(aes(color=QB), alpha=0.2) +
geom_path(filter(QBStats, QB=="Tom Brady"), aes(x=Date, y=PassAccuracy)) +
geom_vline(xintercept = as.numeric(as.Date(c("2006-09-01", "2015-09-01"))), linetype="dashed") +
stat_smooth(method="lm", aes(color=QB)) +
scale_x_date()
traceback()
ggplot(QBStats, aes(x=Date, group=QB, y=PassAccuracy)) +
geom_point(aes(color=QB), alpha=0.2) +
geom_line(filter(QBStats, QB=="Tom Brady"), aes(x=Date, y=PassAccuracy)) +
geom_vline(xintercept = as.numeric(as.Date(c("2006-09-01", "2015-09-01"))), linetype="dashed") +
stat_smooth(method="lm", aes(color=QB)) +
scale_x_date()
ggplot(QBStats, aes(x=Date, group=QB, y=PassAccuracy)) +
geom_point(aes(color=QB), alpha=0.2) +
geom_path(data=filter(QBStats, QB=="Tom Brady"), aes(x=Date, y=PassAccuracy)) +
geom_vline(xintercept = as.numeric(as.Date(c("2006-09-01", "2015-09-01"))), linetype="dashed") +
stat_smooth(method="lm", aes(color=QB)) +
scale_x_date()
ggplot(QBStats, aes(x=Date, group=QB, y=PassAccuracy)) +
geom_point(aes(color=QB), alpha=0.2) +
geom_path(data=filter(QBStats, QB %in% c("Tom Brady", "Aaron Rodgers"), aes(color=QB, x=Date, y=PassAccuracy)) +
geom_vline(xintercept = as.numeric(as.Date(c("2006-09-01", "2015-09-01"))), linetype="dashed") +
stat_smooth(method="lm", aes(color=QB)) +
scale_x_date()
)
ggplot(QBStats, aes(x=Date, group=QB, y=PassAccuracy)) +
geom_point(aes(color=QB), alpha=0.2) +
geom_path(data=filter(QBStats, QB %in% c("Tom Brady", "Aaron Rodgers"), aes(color=QB, x=Date, y=PassAccuracy))) +
geom_vline(xintercept = as.numeric(as.Date(c("2006-09-01", "2015-09-01"))), linetype="dashed") +
stat_smooth(method="lm", aes(color=QB)) +
scale_x_date()
ggplot(QBStats, aes(x=Date, group=QB, y=PassAccuracy)) +
geom_point(aes(color=QB), alpha=0.2) +
geom_path(data=filter(QBStats, QB %in% c("Tom Brady", "Aaron Rodgers"), aes(color=QB, x=Date, y=PassAccuracy))) +
geom_vline(xintercept = as.numeric(as.Date(c("2006-09-01", "2015-09-01"))), linetype="dashed") +
stat_smooth(method="lm", aes(color=QB)) +
scale_x_date()
ggplot(QBStats, aes(x=Date, group=QB, y=PassAccuracy)) +
geom_point(aes(color=QB), alpha=0.2) +
geom_path(data=filter(QBStats, QB %in% c("Tom Brady", "Aaron Rodgers")), aes(color=QB, x=Date, y=PassAccuracy)) +
geom_vline(xintercept = as.numeric(as.Date(c("2006-09-01", "2015-09-01"))), linetype="dashed") +
stat_smooth(method="lm", aes(color=QB)) +
scale_x_date()
ggplot(data=filter(QBStats, year>2014), aes(x=Date, group=QB, y=PassAccuracy)) +
geom_point(aes(color=QB), alpha=0.2) +
geom_path(data=filter(QBStats, QB %in% c("Tom Brady", "Aaron Rodgers")), aes(color=QB, x=Date, y=PassAccuracy)) +
geom_vline(xintercept = as.numeric(as.Date(c("2006-09-01", "2015-09-01"))), linetype="dashed") +
stat_smooth(method="lm", aes(color=QB)) +
scale_x_date()
ggplot(data=filter(QBStats, Year>2014), aes(x=Date, group=QB, y=PassAccuracy)) +
geom_point(aes(color=QB), alpha=0.2) +
geom_path(data=filter(QBStats, QB %in% c("Tom Brady", "Aaron Rodgers")), aes(color=QB, x=Date, y=PassAccuracy)) +
geom_vline(xintercept = as.numeric(as.Date(c("2006-09-01", "2015-09-01"))), linetype="dashed") +
stat_smooth(method="lm", aes(color=QB)) +
scale_x_date()
ggplot(data=filter(QBStats, Year>2014), aes(x=Date, group=QB, y=PassAccuracy)) +
geom_point(aes(color=QB), alpha=0.2) +
geom_path(data=filter(QBStats, QB %in% c("Tom Brady", "Aaron Rodgers"), Year>2014), aes(color=QB, x=Date, y=PassAccuracy)) +
geom_vline(xintercept = as.numeric(as.Date(c("2006-09-01", "2015-09-01"))), linetype="dashed") +
stat_smooth(method="lm", aes(color=QB)) +
scale_x_date()
ggplot(data=filter(QBStats, Year>2013), aes(x=Date, group=QB, y=PassAccuracy)) +
geom_point(aes(color=QB), alpha=0.2) +
geom_path(data=filter(QBStats, QB %in% c("Tom Brady", "Aaron Rodgers"), Year>2013), aes(color=QB, x=Date, y=PassAccuracy)) +
geom_vline(xintercept = as.numeric(as.Date(c("2006-09-01", "2015-09-01"))), linetype="dashed") +
stat_smooth(method="lm", aes(color=QB)) +
scale_x_date()
df <- QBStats %>% filter(Year>=2014, Year<2016)
ggplot(df, aes(x=Date, group=QB, y=PassAccuracy)) +
geom_point(aes(color=QB), alpha=0.2) +
geom_path(data=filter(df, QB %in% c("Tom Brady", "Aaron Rodgers")), aes(color=QB, x=Date, y=PassAccuracy)) +
geom_vline(xintercept = as.numeric(as.Date(c("2006-09-01", "2015-09-01"))), linetype="dashed") +
stat_smooth(method="lm", aes(color=QB)) +
scale_x_date()
ggplot(df, aes(x=Year, group=QB, y=PassAccuracy)) +
geom_point(aes(color=QB), alpha=0.2) +
geom_path(data=filter(df, QB %in% c("Tom Brady", "Aaron Rodgers")), aes(color=QB, x=Year, y=PassAccuracy)) +
geom_vline(xintercept = as.numeric(as.Date(c("2006-09-01", "2015-09-01"))), linetype="dashed") +
stat_smooth(method="lm", aes(color=QB)) +
scale_x_date()
ggplot(df, aes(x=Date, group=QB, y=PassAccuracy)) +
geom_point(aes(color=QB), alpha=0.2) +
geom_path(data=filter(df, QB %in% c("Tom Brady", "Aaron Rodgers")), aes(color=QB, x=Date, y=PassAccuracy)) +
geom_vline(xintercept = as.numeric(as.Date(c("2006-09-01", "2015-09-01"))), linetype="dashed") +
stat_smooth(method="lm", aes(color=QB)) +
scale_x_date()
ggplot(df, aes(x=Date, group=QB, y=QBRating)) +
geom_point(aes(color=QB), alpha=0.2) +
geom_path(data=filter(df, QB %in% c("Tom Brady", "Aaron Rodgers")), aes(color=QB, x=Date, y=QBRating)) +
geom_vline(xintercept = as.numeric(as.Date(c("2006-09-01", "2015-09-01"))), linetype="dashed") +
stat_smooth(method="lm", aes(color=QB)) +
scale_x_date()
library(tidyverse)
library(ffanalytics)
runScrape(week = 5, season = 2016, analysts = c(-1, 5, 7, 18, 27), positions = c("QB", "RB", "WR", "TE", "K", "DST"))
View(playerData)
View(playerData)
analysts
runScrape(week = 5, season = 2016, analysts = c(18, 27), positions = c("QB", "RB", "WR", "TE", "K", "DST"))
runScrape(week = 8, season = 2016, analysts = c(18, 27), positions = c("QB", "RB", "WR", "TE", "K", "DST"))
df <- runScrape(week = 5, season = 2016, analysts = c(-1, 5, 7, 18, 27), positions = c("QB", "RB", "WR", "TE", "K", "DST"))
df
df$WR
df <- runScrape(week = 8, season = 2016, analysts = c(-1, 5, 7, 18, 27), positions = c("QB", "RB", "WR", "TE", "K", "DST"))
analysts
df$QB
qb<-df$QB
qb<-data.frame(df$QB)
df$QB
getProjections(df, avgMethod = "average", leagueScoring = userScoring, teams = 12, format = "standard", mflMocks = -1, mflLeagues = -1, adpSources = c("CBS", "ESPN", "FFC", "MFL", "NFL"))
scoringRules <- list(
QB = data.table::data.table(dataCol = c("passYds", "passTds", "passInt", "rushYds", "rushTds", "twoPts", "fumbles"),
multiplier = c(1/25, 4, -3, 1/10, 6, 2, -3 )),
RB = data.table::data.table(dataCol = c("rushYds", "rushTds", "rec", "recYds", "recTds", "returnTds", "twoPts", "fumbles"),
multiplier = c(1/10, 6, 0, 1/8, 6, 6, 2, -3)),
WR = data.table::data.table(dataCol = c("rushYds", "rushTds", "rec", "recYds", "recTds", "returnTds", "twoPts", "fumbles"),
multiplier = c(1/10, 6, 0, 1/8, 6, 6, 2, -3)),
TE = data.table::data.table(dataCol = c("rushYds", "rushTds", "rec", "recYds", "recTds", "returnTds", "twoPts", "fumbles"),
multiplier = c(1/10, 6, 0, 1/8, 6, 6, 2, -3)),
K = data.table::data.table(dataCol = c("xp", "fg0019", "fg2029", "fg3039", "fg4049", "fg50"),
multiplier = c(1,  3, 3, 3, 4, 5)),
DST = data.table::data.table(dataCol = c("dstFumlRec", "dstInt", "dstSafety", "dstSack", "dstTd", "dstBlk"),
multiplier = c(2, 2, 2, 1, 6, 1.5)),
DL = data.table::data.table(dataCol = c("idpSolo", "idpAst", "idpSack", "idpInt", "idpFumlForce", "idpFumlRec", "idpPD", "idpTd", "idpSafety"),
multiplier = c(1, 0.5, 2, 3, 3, 2, 1, 6, 2)),
LB =  data.table::data.table(dataCol = c("idpSolo", "idpAst", "idpSack", "idpInt", "idpFumlForce", "idpFumlRec", "idpPD", "idpTd", "idpSafety"),
multiplier = c(1, 0.5, 2, 3, 3, 2, 1, 6, 2)),
DB = data.table::data.table(dataCol = c("idpSolo", "idpAst", "idpSack", "idpInt", "idpFumlForce", "idpFumlRec", "idpPD", "idpTd", "idpSafety"),
multiplier = c(1, 0.5, 2, 3, 3, 2, 1, 6, 2)),
ptsBracket = data.table::data.table(threshold = c(0, 6, 20, 34, 99),
points = c(10, 7, 4, 0, -4))
getProjections(df, avgMethod = "average", leagueScoring = scoringRules, teams = 12, format = "standard", mflMocks = -1, mflLeagues = -1, adpSources = c("CBS", "ESPN", "FFC", "MFL", "NFL"))
scoringRules <- list(
QB = data.table::data.table(dataCol = c("passYds", "passTds", "passInt", "rushYds", "rushTds", "twoPts", "fumbles"),
multiplier = c(1/25, 4, -3, 1/10, 6, 2, -3 )),
RB = data.table::data.table(dataCol = c("rushYds", "rushTds", "rec", "recYds", "recTds", "returnTds", "twoPts", "fumbles"),
multiplier = c(1/10, 6, 0, 1/8, 6, 6, 2, -3)),
WR = data.table::data.table(dataCol = c("rushYds", "rushTds", "rec", "recYds", "recTds", "returnTds", "twoPts", "fumbles"),
multiplier = c(1/10, 6, 0, 1/8, 6, 6, 2, -3)),
TE = data.table::data.table(dataCol = c("rushYds", "rushTds", "rec", "recYds", "recTds", "returnTds", "twoPts", "fumbles"),
multiplier = c(1/10, 6, 0, 1/8, 6, 6, 2, -3)),
K = data.table::data.table(dataCol = c("xp", "fg0019", "fg2029", "fg3039", "fg4049", "fg50"),
multiplier = c(1,  3, 3, 3, 4, 5)),
DST = data.table::data.table(dataCol = c("dstFumlRec", "dstInt", "dstSafety", "dstSack", "dstTd", "dstBlk"),
multiplier = c(2, 2, 2, 1, 6, 1.5)),
DL = data.table::data.table(dataCol = c("idpSolo", "idpAst", "idpSack", "idpInt", "idpFumlForce", "idpFumlRec", "idpPD", "idpTd", "idpSafety"),
multiplier = c(1, 0.5, 2, 3, 3, 2, 1, 6, 2)),
LB =  data.table::data.table(dataCol = c("idpSolo", "idpAst", "idpSack", "idpInt", "idpFumlForce", "idpFumlRec", "idpPD", "idpTd", "idpSafety"),
multiplier = c(1, 0.5, 2, 3, 3, 2, 1, 6, 2)),
DB = data.table::data.table(dataCol = c("idpSolo", "idpAst", "idpSack", "idpInt", "idpFumlForce", "idpFumlRec", "idpPD", "idpTd", "idpSafety"),
multiplier = c(1, 0.5, 2, 3, 3, 2, 1, 6, 2)),
ptsBracket = data.table::data.table(threshold = c(0, 6, 20, 34, 99),
points = c(10, 7, 4, 0, -4)))
getProjections(df, avgMethod = "average", leagueScoring = scoringRules, teams = 12, format = "standard", mflMocks = -1, mflLeagues = -1, adpSources = c("CBS", "ESPN", "FFC", "MFL", "NFL"))
library(tidyverse)
library(ggthemes)
theme_set(theme_bw())
load("QBStats.Rda")
head(QBStats)
QBStats$Period <- ifelse(as.numeric(as.Date(QBStats$Date)) < as.numeric(as.Date("2006-09-01")), "Pre",
ifelse(as.numeric(as.Date(QBStats$Date)) < as.numeric(as.Date("2015-09-01")), "During", "Current"))
QBStats$QB <- as.factor(ifelse(QBStats$Player=="Aaron Rodgers", "Aaron Rodgers",
ifelse(QBStats$Player=="Tom Brady", "Tom Brady", "Other")))
df <- QBStats %>% filter(Year>=2014, Year<2016)
ggplot(df, aes(x=Date, group=QB, y=QBRating)) +
geom_point(aes(color=QB), alpha=0.2) +
geom_path(data=filter(df, QB %in% c("Tom Brady", "Aaron Rodgers")), aes(color=QB, x=Date, y=QBRating)) +
geom_vline(xintercept = as.numeric(as.Date(c("2006-09-01", "2015-09-01"))), linetype="dashed") +
stat_smooth(method="lm", aes(color=QB)) +
scale_x_date()
PassStats <- QBStats %>% filter(Player!="Tom Brady", Type=="RegularSeason", Year>=2004) %>%
group_by(Year, GameNum) %>%
summarise(AverageDate=as.Date(mean(as.numeric(as.Date(Date))), origin="1970-01-01"),
Attempts.M=mean(PassAttempt), Attempts.SD=sd(PassAttempt),
Completed.M=mean(PassComplete), Completed.SD=sd(PassComplete),
Accuracy.M=mean(PassAccuracy), Accuracy.SD=sd(PassAccuracy))
ggplot(PassStats, aes(x=AverageDate, y=Accuracy.M)) + geom_smooth()
plot(cars)
---
title: "R Notebook"
output: html_notebook
---
plot(cars)
plot(cars)
library(tidyverse)
library(rvest)
library(stringr)
load("QBStats.Rda")
QBStats$Period <- ifelse(as.numeric(as.Date(QBStats$Date)) < as.numeric(as.Date("2006-09-01")), "Pre",
ifelse(as.numeric(as.Date(QBStats$Date)) < as.numeric(as.Date("2015-09-01")), "During", "Current"))
QBStats$QB <- as.factor(ifelse(QBStats$Player=="Aaron Rodgers", "Aaron Rodgers",
ifelse(QBStats$Player=="Tom Brady", "Tom Brady", "Other")))
df <- QBStats %>% filter(Year>=2014, Year<2016)
ggplot(df, aes(x=Date, group=QB, y=QBRating)) +
geom_point(aes(color=QB), alpha=0.2) +
geom_path(data=filter(df, QB %in% c("Tom Brady", "Aaron Rodgers")), aes(color=QB, x=Date, y=QBRating)) +
geom_vline(xintercept = as.numeric(as.Date(c("2006-09-01", "2015-09-01"))), linetype="dashed") +
stat_smooth(method="lm", aes(color=QB)) +
scale_x_date()
theme_set(theme_bw())
ggplot(df, aes(x=Date, group=QB, y=QBRating)) +
geom_point(aes(color=QB), alpha=0.2) +
geom_path(data=filter(df, QB %in% c("Tom Brady", "Aaron Rodgers")), aes(color=QB, x=Date, y=QBRating)) +
geom_vline(xintercept = as.numeric(as.Date(c("2006-09-01", "2015-09-01"))), linetype="dashed") +
stat_smooth(method="lm", aes(color=QB)) +
scale_x_date()
PassStats <- QBStats %>% filter(Player!="Tom Brady", Type=="RegularSeason", Year>=2004) %>%
group_by(Year, GameNum) %>%
summarise(AverageDate=as.Date(mean(as.numeric(as.Date(Date))), origin="1970-01-01"),
Attempts.M=mean(PassAttempt), Attempts.SD=sd(PassAttempt),
Completed.M=mean(PassComplete), Completed.SD=sd(PassComplete),
Accuracy.M=mean(PassAccuracy), Accuracy.SD=sd(PassAccuracy))
ggplot(PassStats, aes(x=AverageDate, y=Accuracy.M)) + geom_smooth()
